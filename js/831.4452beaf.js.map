{"version":3,"file":"js/831.4452beaf.js","mappings":"mKAGO,MAAMA,EAAiB,KACrBC,EAAAA,EAAAA,GAAQ,CACbC,IAAK,sB,mHCFF,MAAMC,EAAW,KACfF,EAAAA,EAAAA,GAAQ,CACbC,IAAK,eAIIE,EAAkBC,IACtBJ,EAAAA,EAAAA,GAAQ,CACbC,IAAM,oBAAmBG,MAIhBC,EAAwBC,IAC5BN,EAAAA,EAAAA,GAAQ,CACbC,IAAK,8BACLM,OAAQ,OACRD,KAAAA,K,kUC6BEE,GAAOC,EAAAA,EAAAA,MACPC,EAAYC,gBACVN,EAAAA,EAAAA,IAAqB,CACzBD,OAAQQ,EAAMR,OACdS,YAAaC,EAAQC,MAAMC,mBAE7BC,EAAAA,GAAAA,QAAkBT,EAAKU,EAAE,+BACzBC,KAIIA,EAAS,KACbC,EAAM,qBAAqB,IAIvBC,GAAgBC,EAAAA,EAAAA,IAAI,IACpBC,EAAoBZ,UACxBU,EAAcN,YAAchB,EAAAA,EAAAA,MAE9BwB,KACAC,EAAAA,EAAAA,GAAgBD,GAGhB,MAAME,EAAe,CACnBC,SAAU,WACVC,MAAO,kBAIHb,GAAUQ,EAAAA,EAAAA,IAAI,MAEdM,EAAoBjB,UACxB,MAAMkB,QAAoB1B,EAAAA,EAAAA,IAAeS,EAAMR,QAC/CU,EAAQC,MAAMe,eAAeD,I,OAE/BE,EAAAA,EAAAA,KACE,IAAMnB,EAAMR,SACZ4B,IACMA,GAAKJ,O,0qBCpFb,MAAMK,EAAc,EAEpB,Q,mCCgCA,MAAMC,GAAWZ,EAAAA,EAAAA,IAAI,IACfa,EAAcxB,UAClBuB,EAASnB,YAAcb,EAAAA,EAAAA,OAEzBiC,KACAX,EAAAA,EAAAA,GAAgBW,KAEhB,MAAMC,GAA8Bd,EAAAA,EAAAA,KAAI,GAClCe,GAAef,EAAAA,EAAAA,IAAI,IACnBgB,EAA8BC,IAClCH,EAA4BrB,OAAQ,EACpCsB,EAAatB,MAAQwB,EAAIC,I,ihCC7C3B,MAAM,EAAc,EAEpB","sources":["webpack://imooc-admin/./src/api/permission.js","webpack://imooc-admin/./src/api/role.js","webpack://imooc-admin/./src/views/role-list/components/DistributePermission.vue","webpack://imooc-admin/./src/views/role-list/components/DistributePermission.vue?4fbf","webpack://imooc-admin/./src/views/role-list/RoleList.vue","webpack://imooc-admin/./src/views/role-list/RoleList.vue?da88"],"sourcesContent":["import request from '@/utils/request'\r\n\r\n// 获取所有权限\r\nexport const permissionList = () => {\r\n  return request({\r\n    url: '/permission/list'\r\n  })\r\n}\r\n","import request from '@/utils/request'\r\n\r\n// 获取所有的角色\r\nexport const roleList = () => {\r\n  return request({\r\n    url: '/role/list'\r\n  })\r\n}\r\n// 获取指定角色的权限\r\nexport const rolePermission = (roleId) => {\r\n  return request({\r\n    url: `/role/permission/${roleId}`\r\n  })\r\n}\r\n// 为角色修改权限\r\nexport const distributePermission = (data) => {\r\n  return request({\r\n    url: '/role/distribute-permission',\r\n    method: 'POST',\r\n    data\r\n  })\r\n}\r\n","<template>\r\n  <el-dialog\r\n    :title=\"$t('msg.excel.roleDialogTitle')\"\r\n    :model-value=\"modelValue\"\r\n    @close=\"closed\"\r\n  >\r\n    <el-tree\r\n      ref=\"treeRef\"\r\n      :data=\"allPermission\"\r\n      show-checkbox\r\n      check-strictly\r\n      node-key=\"id\"\r\n      default-expand-all\r\n      :props=\"defaultProps\"\r\n    >\r\n    </el-tree>\r\n    <template #footer>\r\n      <span class=\"dialog-footer\">\r\n        <el-button @click=\"closed\">{{ $t('msg.universal.cancel') }}</el-button>\r\n        <el-button type=\"primary\" @click=\"onConfirm\">{{\r\n            $t('msg.universal.confirm')\r\n          }}</el-button>\r\n      </span>\r\n    </template>\r\n  </el-dialog>\r\n</template>\r\n\r\n<script setup>\r\nimport { defineProps, defineEmits, ref, watch } from 'vue'\r\nimport { watchSwitchLang } from '@/utils/i18n'\r\nimport { permissionList } from '@/api/permission'\r\nimport { distributePermission, rolePermission } from '@/api/role'\r\nimport { ElMessage } from 'element-plus'\r\nimport { useI18n } from 'vue-i18n'\r\n\r\nconst props = defineProps({\r\n  modelValue: {\r\n    type: Boolean,\r\n    required: true\r\n  },\r\n  roleId: {\r\n    type: String,\r\n    required: true\r\n  }\r\n})\r\nconst emits = defineEmits(['update:modelValue'])\r\n\r\n// 确定按钮点击事件\r\nconst i18n = useI18n()\r\nconst onConfirm = async () => {\r\n  await distributePermission({\r\n    roleId: props.roleId,\r\n    permissions: treeRef.value.getCheckedKeys()\r\n  })\r\n  ElMessage.success(i18n.t('msg.role.updateRoleSuccess'))\r\n  closed()\r\n}\r\n\r\n// 关闭\r\nconst closed = () => {\r\n  emits('update:modelValue', false)\r\n}\r\n\r\n// 所有权限\r\nconst allPermission = ref([])\r\nconst getPermissionList = async () => {\r\n  allPermission.value = await permissionList()\r\n}\r\ngetPermissionList()\r\nwatchSwitchLang(getPermissionList)\r\n\r\n// 属性结构配置\r\nconst defaultProps = {\r\n  children: 'children',\r\n  label: 'permissionName'\r\n}\r\n\r\n// ref\r\nconst treeRef = ref(null)\r\n// 获取当前用户角色的权限\r\nconst getRolePermission = async () => {\r\n  const checkedKeys = await rolePermission(props.roleId)\r\n  treeRef.value.setCheckedKeys(checkedKeys)\r\n}\r\nwatch(\r\n  () => props.roleId,\r\n  val => {\r\n    if (val) getRolePermission()\r\n  }\r\n)\r\n</script>\r\n","import script from \"./DistributePermission.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./DistributePermission.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\r\n  <div class=\"\">\r\n    <el-card>\r\n      <el-table :data=\"allRoles\" border style=\"width: 100%\">\r\n        <el-table-column :label=\"$t('msg.role.index')\" type=\"index\" width=\"120\">\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('msg.role.name')\" prop=\"title\">\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('msg.role.desc')\" prop=\"describe\">\r\n        </el-table-column>\r\n        <el-table-column\r\n          :label=\"$t('msg.role.action')\"\r\n          prop=\"action\"\r\n          width=\"260\"\r\n          #default=\"{ row }\"\r\n        >\r\n          <el-button\r\n            type=\"primary\"\r\n            size=\"mini\"\r\n            @click=\"onDistributePermissionClick(row)\"\r\n            v-permission=\"['distributePermission']\"\r\n          >\r\n            {{ $t('msg.role.assignPermissions') }}\r\n          </el-button>\r\n        </el-table-column>\r\n      </el-table>\r\n    </el-card>\r\n    <DistributePermission  v-model=\"distributePermissionVisible\" :roleId=\"selectRoleId\"/>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue'\r\nimport { roleList } from '@/api/role'\r\nimport { watchSwitchLang } from '@/utils/i18n'\r\nimport DistributePermission from '@/views/role-list/components/DistributePermission'\r\n\r\nconst allRoles = ref([])\r\nconst getRoleList = async () => {\r\n  allRoles.value = await roleList()\r\n}\r\ngetRoleList()\r\nwatchSwitchLang(getRoleList())\r\n\r\nconst distributePermissionVisible = ref(false)\r\nconst selectRoleId = ref('')\r\nconst onDistributePermissionClick = row => {\r\n  distributePermissionVisible.value = true\r\n  selectRoleId.value = row.id\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped></style>\r\n","import script from \"./RoleList.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./RoleList.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["permissionList","request","url","roleList","rolePermission","roleId","distributePermission","data","method","i18n","useI18n","onConfirm","async","props","permissions","treeRef","value","getCheckedKeys","ElMessage","t","closed","emits","allPermission","ref","getPermissionList","watchSwitchLang","defaultProps","children","label","getRolePermission","checkedKeys","setCheckedKeys","watch","val","__exports__","allRoles","getRoleList","distributePermissionVisible","selectRoleId","onDistributePermissionClick","row","id"],"sourceRoot":""}